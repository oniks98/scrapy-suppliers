–ö–õ–û–î
–ó–∞–¥–∞—á–∞ :–î–æ–±–∞–≤–∏—Ç—å –µ—â–µ 4 –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤- 4-—Ö –ø–∞—É–∫–æ–≤
1. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º ‚úÖ

–§–æ–ª–¥–µ—Ä—ã = –∏–µ—Ä–∞—Ä—Ö–∏—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –æ—á–µ–≤–∏–¥–Ω–∞
–ù–µ –Ω—É–∂–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–∞—è –ø–∞–ø–∫–∞ parsers/
–°–µ–ª–µ–∫—Ç–æ—Ä—ã –∂–∏–≤—É—Ç —Ä—è–¥–æ–º —Å –ª–æ–≥–∏–∫–æ–π –ø–∞—É–∫–∞ (1 —Ñ–∞–π–ª = –≤—Å—ë)
–ü—Ä–∏ 100 –ø–∞—É–∫–∞—Ö —ç—Ç–æ –æ—Å—Ç–∞—ë—Ç —á–∏—Å—Ç—ã–º (–≥—Ä—É–ø–ø—ã –≤–∏–¥–Ω—ã)


2. –û–¥–∏–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π Pipeline ‚úÖ
–í–º–µ—Å—Ç–æ –º–æ–µ–≥–æ: ViatecRetailPipeline, EserverRetailPipeline, SecurRetailPipeline...
–í–∞—à –ø–æ–¥—Ö–æ–¥:
python# suppliers/pipelines.py

class SuppliersPipeline:
    """–û–¥–∏–Ω pipeline –¥–ª—è –≤—Å–µ—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤"""
    
    def __init__(self):
        self.files = {}  # {supplier_id: file_handle}
    
    def open_spider(self, spider):
        self.supplier_id = spider.custom_settings.get("supplier_id", "unknown")
        self.output_dir = Path("output")
        self.output_dir.mkdir(exist_ok=True)
    
    def process_item(self, item, spider):
        supplier_id = item.get("supplier_id", self.supplier_id)
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ–∞–π–ª
        if supplier_id not in self.files:
            filename = f"output/{supplier_id}.csv"
            self.files[supplier_id] = open(filename, "w", encoding="utf-8")
            self._write_header(self.files[supplier_id])
        
        # –ü–∏—à–µ–º –≤ –Ω—É–∂–Ω—ã–π CSV
        self._write_row(self.files[supplier_id], item)
        return item
    
    def close_spider(self, spider):
        for f in self.files.values():
            f.close()
–ó–∞—á–µ–º —ç—Ç–æ –ª—É—á—à–µ:

–õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å 10-–π –ø–æ—Å—Ç–∞–≤—â–∏–∫ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è pipelines.py
–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ: supplier_id ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–æ–≤—ã–π —Ñ–∞–π–ª


3. BaseSpider –∫–ª–∞—Å—Å—ã (Optional, –Ω–æ –ø–æ–ª–µ–∑–Ω–æ)
–í–∞—à –ø–æ–¥—Ö–æ–¥ —É–∂–µ —Ö–æ—Ä–æ—à, –Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –¥—É–±–ª–µ–π:
python# suppliers/spiders/base.py

class BaseRetailSpider(scrapy.Spider):
    """–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –ø–∞—É–∫–æ–≤"""
    
    custom_settings = {
        "CONCURRENT_REQUESTS": 8,
        "AUTOTHROTTLE_ENABLED": True,
    }
    
    price_type = "retail"
    
    def parse_item(self, element):
        """–ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ –∫–∞–∂–¥–æ–º –ø–∞—É–∫–µ"""
        raise NotImplementedError
–¢–æ–≥–¥–∞ –∫–∞–∂–¥—ã–π –ø–∞—É–∫:
python# suppliers/spiders/eserver/retail.py

from suppliers.spiders.base import BaseRetailSpider

class EserverRetailSpider(BaseRetailSpider):
    name = "eserver_retail"
    supplier_id = "eserver"
    start_urls = ["https://eserver.ua/..."]
    
    def parse(self, response):
        for product in response.css("div.product"):
            yield self.parse_item(product)
    
    def parse_item(self, element):
        return {
            "name": element.css("h2::text").get(),
            "price": element.css(".price::text").get(),
            "supplier_id": self.supplier_id,
            "price_type": self.price_type,
        }
```

**–≠—Ç–æ —É–±–∏—Ä–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –í—Å–µ –ø–∞—É–∫–∏ –Ω–∞—Å–ª–µ–¥—É—é—Ç settings
- –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤ pipeline –≤–º–µ—Å—Ç–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∫–∞–∂–¥–æ–º –ø–∞—É–∫–µ

---

## üîß –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–∞—à–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```
suppliers/
‚îú‚îÄ scrapy.cfg
‚îú‚îÄ settings.py
‚îú‚îÄ .env

‚îú‚îÄ suppliers/
‚îÇ  ‚îú‚îÄ __init__.py
‚îÇ  ‚îú‚îÄ items.py              ‚Üê –û–±—â–∞—è ItemModel
‚îÇ  ‚îú‚îÄ pipelines.py          ‚Üê –û–î–ò–ù —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π pipeline
‚îÇ  ‚îú‚îÄ middlewares.py
‚îÇ  ‚îú‚îÄ settings.py
‚îÇ  
‚îÇ  ‚îú‚îÄ spiders/
‚îÇ  ‚îÇ  ‚îú‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îú‚îÄ base.py            ‚Üê ‚ú® BaseRetailSpider, BaseDealerSpider
‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îú‚îÄ viatec/
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ dealer.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ retail.py
‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îú‚îÄ eserver/
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ retail.py
‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îú‚îÄ secur/
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ retail.py
‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îú‚îÄ neolight/
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ retail.py
‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ lun/
‚îÇ  ‚îÇ     ‚îú‚îÄ __init__.py
‚îÇ  ‚îÇ     ‚îî‚îÄ retail.py
‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ __pycache__/

‚îú‚îÄ tests/
‚îÇ  ‚îú‚îÄ test_viatec.py
‚îÇ  ‚îú‚îÄ test_eserver.py
‚îÇ  ‚îî‚îÄ ...

‚îú‚îÄ data/
‚îÇ  ‚îî‚îÄ ...

‚îî‚îÄ output/
   ‚îú‚îÄ viatec_retail.csv         
   ‚îú‚îÄ viatec_dealer.csv    
   ‚îú‚îÄ eserver_retail.csv
   ‚îú‚îÄ secur_retail.csv
   ‚îú‚îÄ neolight_retail.csv
   ‚îî‚îÄ lun_retail.csv
–ü—Ä–∏–º–µ—Ä: eserver/retail.py
pythonfrom suppliers.spiders.base import BaseRetailSpider

class EserverRetailSpider(BaseRetailSpider):
    name = "eserver_retail"
    supplier_id = "eserver"
    output_filename = "eserver_retail.csv"
    
    start_urls = ["https://eserver.ua/products"]
    
    custom_settings = {
        "ITEM_PIPELINES": {
            "suppliers.pipelines.SuppliersPipeline": 300,
        }
    }
    
    def parse(self, response):
        """–ü–∞—Ä—Å–∏—Ç —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤"""
        for product_card in response.css("div.product-card"):
            url = product_card.css("a::attr(href)").get()
            yield scrapy.Request(url, callback=self.parse_product)
    
    def parse_product(self, response):
        """–ü–∞—Ä—Å–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–æ–≤–∞—Ä–∞"""
        yield {
            "–ù–∞–∑–≤–∞_–ø–æ–∑–∏—Ü—ñ—ó": response.css("h1::text").get("").strip(),
            "–¶—ñ–Ω–∞": response.css(".price::text").get("").strip(),
            "–ù–∞—è–≤–Ω—ñ—Å—Ç—å": response.css(".stock::text").get("").strip(),
            "supplier_id": self.supplier_id,
            "price_type": "retail",
            "output_file": self.output_filename,
        }
–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π pipeline:
python# suppliers/pipelines.py

from pathlib import Path

class SuppliersPipeline:
    """–û–¥–∏–Ω pipeline –¥–ª—è –≤—Å–µ—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤"""
    
    def __init__(self):
        self.files = {}
        self.writers = {}
    
    def open_spider(self, spider):
        self.output_dir = Path("output")
        self.output_dir.mkdir(exist_ok=True)
        spider.logger.info(f"‚úÖ Pipeline –æ—Ç–∫—Ä—ã—Ç –¥–ª—è {spider.name}")
    
    def process_item(self, item, spider):
        output_file = item.get("output_file") or f"{item.get('supplier_id')}.csv"
        filepath = self.output_dir / output_file
        
        # –°–æ–∑–¥–∞—ë–º —Ñ–∞–π–ª –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
        if output_file not in self.files:
            self.files[output_file] = open(filepath, "w", encoding="utf-8", newline="")
            # –ü–∏—à–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            self._write_header(self.files[output_file], item)
            spider.logger.info(f"üìù –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª: {filepath}")
        
        # –ü–∏—à–µ–º —Å—Ç—Ä–æ–∫—É
        self._write_row(self.files[output_file], item)
        return item
    
    def close_spider(self, spider):
        for f in self.files.values():
            f.close()
        spider.logger.info(f"‚úÖ Pipeline –∑–∞–∫—Ä—ã—Ç")
    
    def _write_header(self, file_obj, item):
        """–ü–∏—à–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ CSV"""
        # –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (–º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤)
        header = ";".join(item.keys())
        file_obj.write(header + "\n")
    
    def _write_row(self, file_obj, item):
        """–ü–∏—à–µ—Ç —Å—Ç—Ä–æ–∫—É CSV"""
        row = ";".join(str(v).replace(";", ",") for v in item.values())
        file_obj.write(row + "\n")

–¥–æ–±–∞–≤—å—Ç–µ:

‚úÖ base.py ‚Äî –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –ø–∞—É–∫–æ–≤ (—É–±–∏—Ä–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ settings)
‚úÖ –û–¥–∏–Ω pipeline ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç supplier_id –∏ output_file
‚úÖ –ü–∞–ø–∫–∏ –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º ‚Äî —á–∏—Å—Ç–æ—Ç–∞ + –∏–µ—Ä–∞—Ä—Ö–∏—è
‚úÖ tests/ ‚Äî —Ç–µ—Å—Ç—ã —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞

–≠—Ç–æ –¥–∞—Å—Ç :

üì¶ Production-ready —Å—Ç—Ä—É–∫—Ç—É—Ä—É
üîß –õ—ë–≥–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ (–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–∞–ø–∫—É)
üßπ –ú–∏–Ω–∏–º—É–º –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
üöÄ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –Ω–∞ 100+ –ø–∞—É–∫–æ–≤