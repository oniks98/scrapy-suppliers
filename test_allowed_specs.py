"""
–¢–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ–Ω–æ–≤–ª–µ–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ allowed_specs
"""
import sys
from pathlib import Path

# –î–æ–¥–∞—î–º–æ —à–ª—è—Ö –¥–æ –ø—Ä–æ–µ–∫—Ç—É
sys.path.insert(0, str(Path(__file__).parent))

from suppliers.keywords_generator import ProductKeywordsGenerator
import logging

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
logging.basicConfig(level=logging.DEBUG, format='%(levelname)s: %(message)s')
logger = logging.getLogger(__name__)

# –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
keywords_csv = Path(r"C:\FullStack\Scrapy\data\viatec\viatec_keywords.csv")
generator = ProductKeywordsGenerator(keywords_csv, logger=logger)

# –¢–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ: –∫–∞–º–µ—Ä–∞ –∑ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏ –ø—ñ—Å–ª—è –º–∞–ø–ø—ñ–Ω–≥—É
product_name = "Hikvision DS-2CE16H0T-ITF 5MP 2.8mm TVI"
category_id = "301105"
specs_list = [
    {"name": "–†–æ–∑–¥—ñ–ª—å–Ω–∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å (–ú–ø)", "value": "5", "unit": ""},
    {"name": "–¢–∏–ø –∫–∞–º–µ—Ä–∏", "value": "TVI", "unit": ""},
    {"name": "–§–æ–∫—É—Å–Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å", "value": "2.8", "unit": "–º–º"},
    {"name": "–§–æ—Ä–º-—Ñ–∞–∫—Ç–æ—Ä", "value": "–ö–æ—Ä–ø—É—Å–Ω–∏–π", "unit": ""},
    {"name": "–ù–∞—è–≤–Ω—ñ—Å—Ç—å –Ü–ß-–ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è", "value": "–¢–∞–∫", "unit": ""},
    {"name": "–ö—É—Ç –æ–≥–ª—è–¥—É –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—ñ", "value": "95", "unit": "–≥—Ä–∞–¥."},
    {"name": "–í–∏—Ä–æ–±–Ω–∏–∫", "value": "Hikvision", "unit": ""},  # –î–æ–¥–∞–ª–∏ –≤–∏—Ä–æ–±–Ω–∏–∫–∞!
]

print("\n" + "="*80)
print("üß™ –¢–ï–°–¢ –û–ù–û–í–õ–ï–ù–û–á –°–ò–°–¢–ï–ú–ò allowed_specs")
print("="*80)

print(f"\nüì¶ –¢–æ–≤–∞—Ä: {product_name}")
print(f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä—ñ—è: {category_id}")
print(f"\nüìä –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø—ñ—Å–ª—è –º–∞–ø–ø—ñ–Ω–≥—É:")
for spec in specs_list:
    print(f"  ‚Ä¢ {spec['name']}: {spec['value']} {spec['unit']}")

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ allowed_specs –∑ CSV
category_data = generator.keywords_mapping.get(category_id, {})
allowed_specs = category_data.get('allowed_specs', set())
print(f"\n‚úÖ allowed_specs –∑ CSV:")
for spec in sorted(allowed_specs):
    print(f"  ‚Ä¢ {spec}")

# –ì–µ–Ω–µ—Ä—É—î–º–æ –∫–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞
print("\nüîë –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤ (—Ä–æ—Å—ñ–π—Å—å–∫–æ—é):")
keywords_ru = generator.generate_keywords(product_name, category_id, specs_list, lang='ru')
print(f"\n{keywords_ru}")

print("\nüîë –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤ (—É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é):")
keywords_ua = generator.generate_keywords(product_name, category_id, specs_list, lang='ua')
print(f"\n{keywords_ua}")

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó
print("\n" + "="*80)
print("üîç –ü–ï–†–ï–í–Ü–†–ö–ê –§–Ü–õ–¨–¢–†–ê–¶–Ü–á:")
print("="*80)

print("\n‚úÖ –î–æ–∑–≤–æ–ª–µ–Ω—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (–ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ —É –∫–ª—é—á–æ–≤–∏—Ö —Å–ª–æ–≤–∞—Ö):")
allowed_specs_display = [
    "–†–æ–∑–¥—ñ–ª—å–Ω–∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å (–ú–ø)",
    "–¢–∏–ø –∫–∞–º–µ—Ä–∏",
    "–§–æ–∫—É—Å–Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å",
    "–ö—É—Ç –æ–≥–ª—è–¥—É –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—ñ",
    "–ù–∞—è–≤–Ω—ñ—Å—Ç—å –Ü–ß-–ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è",
    "–í–±—É–¥–æ–≤–∞–Ω–∏–π –º—ñ–∫—Ä–æ—Ñ–æ–Ω",
    "–í–∏—Ä–æ–±–Ω–∏–∫",
    "–ü–æ—Ä—Ç –¥–ª—è SD-–∫–∞—Ä—Ç–∏",
    "–ë–µ–∑–¥—Ä–æ—Ç–æ–≤–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å"
]
for spec in allowed_specs_display:
    print(f"  ‚Ä¢ {spec}")

print("\n‚ùå –ù–µ–¥–æ–∑–≤–æ–ª–µ–Ω—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (–ù–ï –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ —É –∫–ª—é—á–æ–≤–∏—Ö —Å–ª–æ–≤–∞—Ö):")
not_allowed = [
    "–§–æ—Ä–º-—Ñ–∞–∫—Ç–æ—Ä",
    "–¢–∏–ø –º–∞—Ç—Ä–∏—Ü—ñ",
    "–§—ñ–∑–∏—á–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –º–∞—Ç—Ä–∏—Ü—ñ"
]
for spec in not_allowed:
    print(f"  ‚Ä¢ {spec}")

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
print("\nüìù –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:")
keywords_lower = keywords_ru.lower()

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —â–æ —î
if "5mp" in keywords_lower or "5–º–ø" in keywords_lower:
    print("  ‚úÖ –†–æ–∑–¥—ñ–ª—å–Ω–∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å (5mp/5–º–ø) - –ó–ù–ê–ô–î–ï–ù–û")
else:
    print("  ‚ùå –†–æ–∑–¥—ñ–ª—å–Ω–∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å - –ù–ï –ó–ù–ê–ô–î–ï–ù–û")

if "tvi" in keywords_lower:
    print("  ‚úÖ –¢–∏–ø –∫–∞–º–µ—Ä–∏ (tvi) - –ó–ù–ê–ô–î–ï–ù–û")
else:
    print("  ‚ùå –¢–∏–ø –∫–∞–º–µ—Ä–∏ - –ù–ï –ó–ù–ê–ô–î–ï–ù–û")

if "2.8" in keywords_lower:
    print("  ‚úÖ –§–æ–∫—É—Å–Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å (2.8) - –ó–ù–ê–ô–î–ï–ù–û")
else:
    print("  ‚ùå –§–æ–∫—É—Å–Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å - –ù–ï –ó–ù–ê–ô–î–ï–ù–û")

if "hikvision" in keywords_lower:
    print("  ‚úÖ –í–∏—Ä–æ–±–Ω–∏–∫ (Hikvision) - –ó–ù–ê–ô–î–ï–ù–û")
else:
    print("  ‚ùå –í–∏—Ä–æ–±–Ω–∏–∫ - –ù–ï –ó–ù–ê–ô–î–ï–ù–û")

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —â–æ –Ü–ß-–ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è –ü–†–ò–°–£–¢–ù–Ñ (—Ç–µ–ø–µ—Ä –≤–æ–Ω–æ –¥–æ–∑–≤–æ–ª–µ–Ω–µ!)
if "–∏–∫-–ø–æ–¥—Å–≤–µ—Ç" in keywords_lower or "—ñ—á-–ø—ñ–¥—Å–≤—ñ—Ç–∫" in keywords_lower:
    print("  ‚úÖ –Ü–ß-–ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è - –ó–ù–ê–ô–î–ï–ù–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –±–æ –≤–∏ –¥–æ–¥–∞–ª–∏ –≤ allowed_specs!)")
else:
    print("  ‚ùå –Ü–ß-–ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è - –ù–ï –ó–ù–ê–ô–î–ï–ù–û")

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —â–æ –ù–ï–¥–æ–∑–≤–æ–ª–µ–Ω—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω—ñ
if "–∫–æ—Ä–ø—É—Å" in keywords_lower:
    print("  ‚ùå –§–æ—Ä–º-—Ñ–∞–∫—Ç–æ—Ä - –ó–ù–ê–ô–î–ï–ù–û (–ø–æ–º–∏–ª–∫–∞! –Ω–µ –ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏)")
else:
    print("  ‚úÖ –§–æ—Ä–º-—Ñ–∞–∫—Ç–æ—Ä - –ü–†–ê–í–ò–õ–¨–ù–û –í–Ü–î–§–Ü–õ–¨–¢–†–û–í–ê–ù–û")

if "cmos" in keywords_lower or "–º–∞—Ç—Ä–∏—Ü" in keywords_lower:
    print("  ‚ùå –¢–∏–ø –º–∞—Ç—Ä–∏—Ü—ñ - –ó–ù–ê–ô–î–ï–ù–û (–ø–æ–º–∏–ª–∫–∞! –Ω–µ –ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏)")
else:
    print("  ‚úÖ –¢–∏–ø –º–∞—Ç—Ä–∏—Ü—ñ - –ü–†–ê–í–ò–õ–¨–ù–û –í–Ü–î–§–Ü–õ–¨–¢–†–û–í–ê–ù–û")

print("\n" + "="*80)
print("‚úÖ –¢–ï–°–¢ –ó–ê–í–ï–†–®–ï–ù–û")
print("="*80)
